# Epic 10-13: Complete App Flow Implementation

## 🎯 **Background: App Overview**

**App Name:** ClipForge (working title)

**Goal:** a simple, local-first desktop video tool (Electron + React + FFmpeg) that lets users:

1. Import existing clips and edit them quickly.
2. Record new material (screen, mic, camera) and automatically enter the same editing workspace.
3. Optionally use AI to mute filler words like "uh" and "um."

### 🏠 **Welcome Screen**

The user lands on a single, minimal home view that acts as the entry point for all flows.

```
Welcome Screen

 ├── [Import Video] → import flow

 ├── [Screen Recording] → screen flow

 └── [Screen + Overlay] → overlay flow
```

Each button briefly describes what it does:

* **Import Video:** edit an existing clip (trim, speed, resolution).
* **Screen Recording:** record your screen + mic.
* **Screen + Overlay:** record your screen and webcam together.

After recording in either flow, the exported clip is automatically imported into the editing workspace from Epic 10.

---

## 🧩 **Epic 10 – Import Video Flow (Editor Core)**

**Goal:**

Implement the base editing workspace that all recordings feed into.

Supports importing a video, previewing, trimming, changing playback speed and output resolution, and exporting the edited clip.

**Deliverables / Tasks**

1. **Import & Metadata**

   * File picker for supported formats (MP4, MOV, WebM).

   * Use `ipcClient.getMetadata()` to populate duration, fps, resolution.

2. **Video Preview**

   * Video player with play/pause/scrub support.

   * Sync playhead position with timeline.

3. **Timeline Editor**

   * Single track with trim handles + draggable playhead.

   * Display timestamps, zoom controls.

4. **Adjustments Panel**

   * Speed selector (0.5×–2×).

   * Resolution scaling dropdown (25 %–200 %).

   * Placeholder toggle for future "AI mute filler words."

5. **Export Workflow**

   * "Export Video" button → run FFmpeg trim + scale + speed filters.

   * Progress bar and completion message with saved file path.

**Integration**

* Central store (`useVideoStore`) manages current clip path, start/end times, playback speed, output settings.

* Export service reused by later epics.

**Testing Milestones**

* ✅ Import a local file → preview works.

* ✅ Trim and export subset correctly.

* ✅ Speed/resolution adjustments reflected in export.

* ✅ Metadata accurate.

---

## 🖥️ **Epic 11 – Screen-Only Recording Flow**

**Goal:**

Let the user record the screen with microphone input, save it locally, and automatically open the recording in the editor from Epic 10.

**Deliverables / Tasks**

1. **Source Selection**

   * List available screens/windows via `desktopCapturer.getSources()`.

   * Show thumbnail + name; allow selection.

2. **Recording Controls**

   * "Preview / Record / Stop" buttons.

   * Mic input selector from `enumerateDevices()`.

3. **Recording Implementation**

   * Use `getDisplayMedia({ video:true })` for video.

   * Use `getUserMedia({ audio:true })` for mic.

   * Combine tracks into a single `MediaStream` and record with `MediaRecorder`.

4. **Post-Recording Handling**

   * On stop, save via `ipcClient.saveRecording()`.

   * Display short "Processing…" overlay.

   * Auto-redirect to the editor, importing the saved file.

5. **Error Handling**

   * Detect when audio tracks are missing (e.g., Linux limitations) and show warning.

**Testing Milestones**

* ✅ Screen sources detected.

* ✅ 5 s recording saves successfully.

* ✅ Imported automatically into editor.

* ✅ Export from editor works as normal.

---

## 🎥 **Epic 12 – Screen + Overlay Recording Flow**

**Goal:**

Enable users to record both screen and webcam simultaneously (with mic audio), combine them into a picture-in-picture (PiP) video, and import that result into the editor.

**Deliverables / Tasks**

1. **Dual Source Setup**

   * Choose screen source and camera device.

   * Show live preview with webcam thumbnail overlay (bottom-right by default).

2. **Dual Recording Logic**

   * Record screen (video + mic) and camera (video + mic) as two separate `MediaRecorder` streams.

3. **Post-Processing Merge**

   * After both complete, merge via FFmpeg:

     ```bash

     ffmpeg -i screen.webm -i camera.webm \

       -filter_complex "[1:v]scale=iw/4:ih/4 [pip]; [0:v][pip] overlay=W-w-20:H-h-20" \

       -c:v libvpx-vp9 -c:a libopus -shortest output_pip.webm

     ```

   * Optionally adjust PiP size/position later.

4. **Auto-Redirect**

   * Once merged, import `output_pip.webm` into the editor flow.

**Testing Milestones**

* ✅ Both sources preview correctly.

* ✅ Dual recording completes without sync errors.

* ✅ FFmpeg merge produces valid PiP video.

* ✅ Auto-redirect loads merged clip in editor.

---

## 🧠 **Epic 13 – AI Auto-Muting (Filler-Word Removal)**

**Goal:**

Add optional AI processing that identifies and mutes filler words ("uh," "um") using OpenAI Whisper for transcription and GPT for text analysis, then applies silence filters via FFmpeg.

**Deliverables / Tasks**

1. **Audio Extraction**

   * Use FFmpeg to extract audio from selected clip (`.wav` or `.flac`).

2. **Transcription**

   * Send audio to Whisper API → receive word-level timestamps.

3. **Filler Detection**

   * Pass transcript (with timestamps) to GPT-4.1-mini → return list of filler intervals.

4. **Mute Processing**

   * Generate an FFmpeg command to set volume = 0 for those intervals (no cut).

5. **Integration with Editor**

   * Add "Auto-mute filler words" toggle.

   * On export, if enabled, run the AI pipeline before final FFmpeg render.

**Testing Milestones**

* ✅ Whisper transcription returns timestamps.

* ✅ GPT identifies filler intervals.

* ✅ FFmpeg output matches original but with muted sections.

* ✅ Toggle disabled → normal export.

---

### 🔄 **Overall Flow Summary**

```
Welcome Screen

 ├── Import Video  →  Epic 10

 ├── Screen Only   →  Epic 11  →  Editor (Epic 10)

 └── Screen+Overlay→  Epic 12  →  Editor (Epic 10)

                               ↘ (optional) Epic 13

```

Each epic builds on the previous, converging on a single editing workspace.

## Current Implementation Status

### Epic 10 (Editor Core) - 90% Complete ✅
- ✅ Video import with file picker
- ✅ Video preview with play/pause/scrub
- ✅ Timeline editor with trim handles
- ✅ Speed and resolution adjustments
- ✅ Export workflow with FFmpeg
- 🔄 **Needs**: Welcome screen entry point, single-track simplification

### Epic 11 (Screen Recording) - 80% Complete ✅
- ✅ Screen recording with system audio
- ✅ Source selection with Electron desktopCapturer
- ✅ Live preview system
- 🔄 **Needs**: Simplification, mic input selector, auto-redirect

### Epic 12 (Screen + Overlay) - 60% Complete ✅
- ✅ Two-track recording system
- ✅ Camera recording with microphone
- 🔄 **Needs**: PiP merging instead of two-track, FFmpeg post-processing

### Epic 13 (AI Muting) - 0% Complete 📋
- 🔄 **Needs**: Complete implementation of Whisper + GPT pipeline
